@using Microsoft.AspNetCore.SignalR.Client
@using CardsAgainstWhatever.Shared.Dtos.Events
@inject HubConnection HubConnection
@inject GameStateContainer GameStateContainer
@inject BlazorComponentBus.ComponentBus Bus

@code {
    protected override async Task OnInitializedAsync()
    {
        HubConnection.On<PlayerJoinedEvent>(nameof(IGameClient.PlayerJoined), Bus.Publish);
        HubConnection.On<RoundStartedEvent>(nameof(IGameClient.RoundStarted), Bus.Publish);
        HubConnection.On<PlayerMovedEvent>(nameof(IGameClient.PlayerMoved), Bus.Publish);
        HubConnection.On<RoundClosedEvent>(nameof(IGameClient.RoundClosed), Bus.Publish);
        HubConnection.On<RoundEndedEvent>(nameof(IGameClient.RoundEnded), Bus.Publish);

        await HubConnection.StartAsync();
    }
}
